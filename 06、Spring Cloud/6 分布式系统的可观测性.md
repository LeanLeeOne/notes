![](../images/6/metrics-tracing-logging.png)

<span style=background:#ffb8b8>监控</span>（<span style=background:#ffb8b8>指标聚合</span>）、<span style=background:#c9ccff>链路追踪</span>、<span style=background:#f8d2ff>日志收集</span>是分布式系统中很重要的3个领域，如[上图](http://peter.bourgon.org/blog/2017/02/21/metrics-tracing-and-logging.html)所示，三者既各有侧重又关系密切：

- 三者各有侧重：
  - 我们往往会对应用的运行状态进行<span style=background:#ffb8b8>监控</span>，而这些被<span style=background:#ffb8b8>监控</span>的状态也叫做<span style=background:#ffb8b8>指标</span>，并且会对这些<span style=background:#ffb8b8>指标</span>进行计时、计数等<span style=background:#ffb8b8>聚合</span>操作。
  - 随着单体应用发展为分布式应用，<span style=background:#c9ccff>请求/响应</span>的<span style=background:#c9ccff>调用链路</span>也由应用内变成了跨应用，想要获取完整的<span style=background:#c9ccff>请求/响应</span>过程，需要对<span style=background:#c9ccff>请求/响应</span>进行<span style=background:#c9ccff>跟踪</span>。
  - <span style=background:#f8d2ff>日志</span>是对<span style=background:#f8d2ff>事件</span>的记录，而对于分布式系统，我们往往需要将散落在各处的<span style=background:#f8d2ff>日志收集</span>起来，进行分析、展示。
- 但三者又关系密切：
  - <span style=background:#ffb8b8>指标</span>包括<span style=background:#c9ccff>请求/响应</span>相关的<span style=background:#ffb8b8>指标</span>。
  - <span style=background:#f8d2ff>事件</span>也包括<span style=background:#c9ccff>请求/响应</span>相关的<span style=background:#f8d2ff>事件</span>。
  - 部分<span style=background:#ffb8b8>聚合</span>操作也会触发相应<span style=background:#f8d2ff>事件</span>，进而被记录为<span style=background:#f8d2ff>日志</span>。

**Prometheus**是一个<span style=background:#ffb8b8>监控</span>系统，但随着时间的发展，也增加了<span style=background:#c9ccff>调用链路</span>的功能，但没有深入<span style=background:#f8d2ff>日志收集</span>领域。

从可视化角度来说，<span style=background:#ffb8b8>指标</span>是容易可视化的，<span style=background:#f8d2ff>日志收集</span>不容易可视化，而<span style=background:#c9ccff>链路追踪</span>介于两者之间。

> [但也有观点认为](https://segmentfault.com/a/1190000039350115)，<span style=background:#f8d2ff>日志收集</span>包含了<span style=background:#ffb8b8>监控</span>和<span style=background:#c9ccff>链路追踪</span>，或者说，基于<span style=background:#f8d2ff>日志收集</span>可以进行<span style=background:#ffb8b8>监控</span>和<span style=background:#c9ccff>链路追踪</span>。
