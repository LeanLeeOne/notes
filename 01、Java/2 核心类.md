## 原理

`String`的不可变是通过`final`关键字和良好的封装来实现的。

`String`实际上是通过**字符数组**来实现的，当然，**Java9**开始使用**字节数组**来实现，以节省内存空间。

1. **Java9**还允许指定字符串拼接的策略。
2. **Java9**还增加`coder`属性来标识编码。

### 关于[字符串池](../03、JVM/2%20内存结构#常量池)



## 编码

### UTF8

采用<span style=background:#ffb8b8>变长</span>编码，即，采用高位字节确定编码长度，具有良好的容错能力，应用于传输。

中文为`3`字节。

### Unicode

采用<span style=background:#f8d2ff>定长</span>编码，两字节。

在Java中，`char`以及`String`在内存中都是以**Unicode**进行编码。

中文为`2`字节。

> [使用`int[]`创建超长的**Unicode**编码](https://zhuanlan.zhihu.com/p/110307661)



## 字符串拼接

### 重载运算符

Java对`+`进行了重载，允许进行字符串拼接。

对于字符串常量的相加（或者说拼接），Java会使用`StringConcatFactory`进行优化。

对于`"a" + "b"`这种字面量的拼接，编译器<span style=background:#c2e2ff>编译时</span>会直接将其编译为`"ab"`，以减少对象的创建。

### StringBuilder

字符串对象是<u>不可变的</u>，所以对于频繁的字符串相加，会带来频繁的字符串对象创建，而`StringBuilder`可以改善该问题。

`StringBuilder`是一个采用<u>链式操作</u>的<u>可变</u>对象，预分配缓冲区，不会创建临时对象。

`StringBuffer`可以看作是`StringBuilder`的早期版本，它通过同步来保证**线程安全**，执行效率相对较低。

### 其他[[1]](https://www.cnblogs.com/abook/p/5527341.html)[[2]](https://www.runoob.com/java/java-string.html)

`string1.concat(string2)`也是对字符串进行拼接。

`String.join()`内部采用了`StringJoiner`来实现字符串的带分隔符拼接。

